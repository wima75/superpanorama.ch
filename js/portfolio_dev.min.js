!function(a){"use strict";var b=function(b,c){this.instance=b,this.options=c,this._blockGotoOnce=!1,this.$portfolio=a(this.instance),this._init()};b.prototype={_init:function(){var b=this;this.$thumbsSlider=a(this.options.thumbsSlider),a.getJSON("portfoliodata.json",function(a){b._gallery=a.gallery,b._enrichGallery(),b._addFigures(),b._initPhotoSwipe()})},_initSliderPro:function(){this.$thumbsSlider.sliderPro({width:500,height:10,fade:!1,arrows:!1,buttons:!1,fullScreen:!1,shuffle:!1,smallSize:500,mediumSize:1e3,largeSize:3e3,thumbnailArrows:!0,autoplay:!1})},_enrichGallery:function(){var b=this;a.each(this._gallery,function(c,d){void 0==d.id&&(d.id=b._cleanUpString(d.title)),a.each(d.images,function(a,c){void 0==c.id&&(c.id=b._cleanUpString(c.title)),c.index=a})})},_cleanUpString:function(a){return a.replace(/ä/g,"ae").replace(/Ä/g,"Ae").replace(/ö/g,"oe").replace(/Ö/g,"Oe").replace(/ü/g,"ue").replace(/Ü/g,"Ue").replace(/[\s]/g,"_").replace(/[^a-z0-9_]/gi,"")},_addFigures:function(){var b='<figure class="effect-portfolio wow" data-wow-duration="{wowDuration}s" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"';b+=' galleryId="{galleryId}">',b+='<img src="photos/400x400/{img}" alt="{title}" itemprop="thumbnail" />',b+="<figcaption>",b+="<h2>{title}</h2>",b+="<p>{description}</p>",b+='<a title="{linktitle}" href="photos/{img}" data-lightbox-gallery="gallery1"></a>',b+="</figcaption>",b+="</figure>";var c=this,d=0;a.each(this._gallery,function(e,f){d>=6&&(d=0),d++;var g=b;g=c._replaceAll(g,"{wowDuration}",d);var h=f.images[0];g=c._replaceAll(g,"{galleryId}",f.id),g=c._replaceAll(g,"{title}",f.title),g=c._replaceAll(g,"{linktitle}",f.title),g=c._replaceAll(g,"{description}",void 0==f.description?"":f.description),g=c._replaceAll(g,"{img}",h.img),a(g).appendTo(c.$portfolio)})},_replaceAll:function(a,b,c){return a.replace(new RegExp(b,"g"),c)},_initPhotoSwipe:function(){var a=this,b=function d(a,b){return a&&(b(a)?a:d(a.parentNode,b))};this.$portfolio.click(function(c){c=c||window.event,c.preventDefault?c.preventDefault():c.returnValue=!1;var d=c.target||c.srcElement,e=b(d,function(a){return a.tagName&&"FIGURE"===a.tagName.toUpperCase()});e&&a._openPhotoSwipeFromClick(e)}),this.$thumbsSlider.on("gotoSlide",function(b){return a._blockGotoOnce?void(a._blockGotoOnce=!1):void a.photoSwipe.goTo(b.index)});var c=a._parseUrl();null!=c&&a._openPhotoSwipeFromDeepLink(c.gid,c.pid)},_parseUrl:function(){var a=window.location.hash.substring(1),b={};if(a.length<5){var c=window.location.pathname,d=c.match(/^\/portfolio\/([A-z_]+)\/([A-z]+)(.jpg)?$/i);return null==d?null:(b.gid=d[1],b.pid=d[2],b)}for(var e=a.split("&"),f=0;f<e.length;f++)if(e[f]){var g=e[f].split("=");g.length<2||(b[g[0]]=g[1])}return b},_findGallery:function(a){for(var b=0;b<this._gallery.length;b++)if(this._gallery[b].id===a)return this._gallery[b];return null},_findPhoto:function(a,b){for(var c=0;c<a.images.length;c++)if(a.images[c].id===b)return a.images[c];return null},_openPhotoSwipeFromClick:function(b){var c=b.getAttribute("galleryId"),d=function(c){if(null==b)return null;var d=a(b),e=window.pageYOffset||document.documentElement.scrollTop,f=d[0].getBoundingClientRect(),g=(f.height-327/981*f.height)/2;return{x:f.left,y:f.top+e+g,w:f.width}};this._openPhotoSwipe(c,null,d)},_openPhotoSwipeFromDeepLink:function(a,b){this._openPhotoSwipe(a,b,null)},_openPhotoSwipe:function(a,b,c){var d=this,e=this._findGallery(a),f=this.$thumbsSlider.data("sliderPro");null!==f&&void 0!==f&&(f.destroy(),this.$thumbsSlider.empty());var g=this._getPhotos(e);this._initSliderPro(),f=this.$thumbsSlider.data("sliderPro"),setTimeout(function(){f.resize()},200);var h=document.querySelectorAll(".pswp")[0],i={galleryUID:a,galleryPIDs:!0,bgOpacity:.9,historyUseHash:!1};if(null==b)this._updateDocumentTitle(e,0);else{var j=this._findPhoto(e,b);i.index=j.index,this._updateDocumentTitle(e,j.index)}null!=c&&(i.getThumbBoundsFn=c),this.photoSwipe=new PhotoSwipe(h,PhotoSwipeUI_Default,g,i),this.photoSwipe.init(),this.photoSwipe.listen("afterChange",function(){var a=this,b=a.getCurrentIndex();d._blockGotoOnce=!0,f.gotoSlide(b),d._blockGotoOnce=!1,d._updateDocumentTitle(e,b)}),this.photoSwipe.listen("close",function(){document.title="superpanorama.ch"})},_updateDocumentTitle:function(a,b){var c=a.images[b];document.title=c.title+" | "+a.title+" | superpanorama.ch"},_getPhotos:function(b){var c=[],d=a('<div class="sp-slides"></div>').appendTo(this.$thumbsSlider),e=a('<div class="sp-thumbnails"></div>').appendTo(this.$thumbsSlider);return a.each(b.images,function(f,g){var h={src:"photos/"+g.img,title:g.title,pid:g.id};void 0!=g.w?(h.w=2100,h.h=700):void 0!=b.w?(h.w=b.w,h.h=b.h):(h.w=2100,h.h=700),c.push(h),a('<div class="sp-slide"></div>').appendTo(d),a('<img class="sp-thumbnail" src="photos/400x400/'+g.img+'" />').appendTo(e)}),c}},a.fn.Portfolio=function(c){var d=Array.prototype.slice.call(arguments,1);return this.each(function(){if("undefined"==typeof a(this).data("Portfolio")){var e=new b(this,c);a(this).data("Portfolio",e)}else if("undefined"!=typeof c){var f=a(this).data("Portfolio");"function"==typeof f[c]&&f[c].apply(f,d)}})}}(jQuery);